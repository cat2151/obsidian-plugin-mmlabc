!function(r,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e=t();for(var n in e)("object"==typeof exports?exports:r)[n]=e[n]}}(self,(()=>(()=>{"use strict";var r={699:r=>{function t(r,e,n,o){var s=Error.call(this,r);return Object.setPrototypeOf&&Object.setPrototypeOf(s,t.prototype),s.expected=e,s.found=n,s.location=o,s.name="SyntaxError",s}function e(r,t,e){return e=e||" ",r.length>t?r:(t-=r.length,r+(e+=e.repeat(t)).slice(0,t))}!function(r,t){function e(){this.constructor=r}e.prototype=t.prototype,r.prototype=new e}(t,Error),t.prototype.format=function(r){var t="Error: "+this.message;if(this.location){var n,o=null;for(n=0;n<r.length;n++)if(r[n].source===this.location.source){o=r[n].text.split(/\r\n|\n|\r/g);break}var s=this.location.start,a=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(s):s,u=this.location.source+":"+a.line+":"+a.column;if(o){var c=this.location.end,i=e("",a.line.toString().length," "),l=o[s.line-1],h=(s.line===c.line?c.column:l.length+1)-s.column||1;t+="\n --\x3e "+u+"\n"+i+" |\n"+a.line+" | "+l+"\n"+i+" | "+e("",s.column-1," ")+e("",h,"^")}else t+="\n at "+u}return t},t.buildMessage=function(r,t){var e={literal:function(r){return'"'+o(r.text)+'"'},class:function(r){var t=r.parts.map((function(r){return Array.isArray(r)?s(r[0])+"-"+s(r[1]):s(r)}));return"["+(r.inverted?"^":"")+t.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(r){return r.description}};function n(r){return r.charCodeAt(0).toString(16).toUpperCase()}function o(r){return r.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(r){return"\\x0"+n(r)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(r){return"\\x"+n(r)}))}function s(r){return r.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(r){return"\\x0"+n(r)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(r){return"\\x"+n(r)}))}function a(r){return e[r.type](r)}return"Expected "+function(r){var t,e,n=r.map(a);if(n.sort(),n.length>0){for(t=1,e=1;t<n.length;t++)n[t-1]!==n[t]&&(n[e]=n[t],e++);n.length=e}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(r)+" but "+function(r){return r?'"'+o(r)+'"':"end of input"}(t)+" found."},r.exports={SyntaxError:t,parse:function(r,e){var n,o,s,a,u={},c=(e=void 0!==e?e:{}).grammarSource,i={CHORDS:Ht},l=Ht,h="/",f="on",p="chord over bass note",b="slash chord inversion",d="upper structure triad",v="upper structure",g="ust",m="us",y="polychord",A="poly",w="/*",k="*/",C="root inv",x="1st inv",L="2nd inv",j="3rd inv",R="close harmony",S="close",F="drop2",O="drop-2",Q="open triad",M="drop4",E="drop-4",P="drop2and4",q="drop-2-and-4",D="no bass",G="bass is root",T="bass plays root",U="bass play root",_="|",B="maj",H="M",z="maj7",I="M7",J="△",K="min",N="m",V="-",W="min7",X="m7",Y="-7",Z=" - ",$="→",rr=/^[,.]/,tr=/^[^*\/]/,er=/^[A-G]/,nr=/^[#\uFF03\u266F]/,or=/^[b\u266D]/,sr=/^[ \t\n\r]/,ar=Dt("/",!1),ur=Dt("on",!1),cr=Dt("chord over bass note",!0),ir=Gt([",","."],!1,!1),lr=Dt("slash chord inversion",!0),hr=Dt("upper structure triad",!0),fr=Dt("upper structure",!0),pr=Dt("UST",!0),br=Dt("US",!0),dr=Dt("polychord",!0),vr=Dt("poly",!0),gr=Dt("/*",!1),mr=Gt(["*","/"],!0,!1),yr=Dt("*/",!1),Ar=Dt("root inv",!0),wr=Dt("1st inv",!0),kr=Dt("2nd inv",!0),Cr=Dt("3rd inv",!0),xr=Dt("close harmony",!0),Lr=Dt("close",!0),jr=Dt("drop2",!0),Rr=Dt("drop-2",!0),Sr=Dt("open triad",!0),Fr=Dt("drop4",!0),Or=Dt("drop-4",!0),Qr=Dt("drop2and4",!0),Mr=Dt("drop-2-and-4",!0),Er=Dt("no bass",!0),Pr=Dt("bass is root",!0),qr=Dt("bass plays root",!0),Dr=Dt("bass play root",!0),Gr=Dt("|",!1),Tr=Gt([["A","G"]],!1,!1),Ur=Gt(["#","＃","♯"],!1,!1),_r=Gt(["b","♭"],!1,!1),Br=Dt("maj",!0),Hr=Dt("M",!1),zr=Dt("maj7",!0),Ir=Dt("M7",!1),Jr=Dt("△",!1),Kr=Dt("min",!0),Nr=Dt("m",!1),Vr=Dt("-",!1),Wr=Dt("min7",!0),Xr=Dt("m7",!1),Yr=Dt("-7",!1),Zr=Tt("whitespace"),$r=Gt([" ","\t","\n","\r"],!1,!1),rt=Tt("hyphen"),tt=Dt(" - ",!1),et=Dt("→",!1),nt=function(r,t){return{event:"chord",root:r,quality:t}},ot=function(r,t,e,n){return{event:"slash chord",upperRoot:r,upperQuality:t,lowerRoot:e,lowerQuality:n}},st=function(r,t,e,n){return{event:"chord over bass note",upperRoot:r,upperQuality:t,lowerRoot:e,lowerQuality:n}},at=function(){return{event:"change slash chord mode to chord over bass note"}},ut=function(){return{event:"change slash chord mode to inversion"}},ct=function(){return{event:"change slash chord mode to polychord"}},it=function(r){return{event:"inline mml",mml:r.join("")}},lt=function(){return{event:"change inversion mode to root inv"}},ht=function(){return{event:"change inversion mode to 1st inv"}},ft=function(){return{event:"change inversion mode to 2nd inv"}},pt=function(){return{event:"change inversion mode to 3rd inv"}},bt=function(){return{event:"change open harmony mode to close"}},dt=function(){return{event:"change open harmony mode to drop2"}},vt=function(){return{event:"change open harmony mode to drop4"}},gt=function(){return{event:"change open harmony mode to drop2and4"}},mt=function(){return{event:"change bass play mode to no bass"}},yt=function(){return{event:"change bass play mode to root"}},At=function(){return{event:"bar"}},wt=function(r,t,e){let n;switch(r){case"C":n=0;break;case"D":n=2;break;case"E":n=4;break;case"F":n=5;break;case"G":n=7;break;case"A":n=9;break;case"B":n=11}return n+=t.length-e.length,n%=12,n},kt=function(){return"#"},Ct=function(){return"b"},xt=function(r){return r},Lt=function(){return"maj"},jt=function(){return"maj"},Rt=function(){return"maj7"},St=function(){return"min"},Ft=function(){return"min"},Ot=function(){return"min7"},Qt=0,Mt=[{line:1,column:1}],Et=0,Pt=[],qt=0;if("startRule"in e){if(!(e.startRule in i))throw new Error("Can't start parsing from rule \""+e.startRule+'".');l=i[e.startRule]}function Dt(r,t){return{type:"literal",text:r,ignoreCase:t}}function Gt(r,t,e){return{type:"class",parts:r,inverted:t,ignoreCase:e}}function Tt(r){return{type:"other",description:r}}function Ut(t){var e,n=Mt[t];if(n)return n;for(e=t-1;!Mt[e];)e--;for(n={line:(n=Mt[e]).line,column:n.column};e<t;)10===r.charCodeAt(e)?(n.line++,n.column=1):n.column++,e++;return Mt[t]=n,n}function _t(r,t,e){var n=Ut(r),o=Ut(t),s={source:c,start:{offset:r,line:n.line,column:n.column},end:{offset:t,line:o.line,column:o.column}};return e&&c&&"function"==typeof c.offset&&(s.start=c.offset(s.start),s.end=c.offset(s.end)),s}function Bt(r){Qt<Et||(Qt>Et&&(Et=Qt,Pt=[]),Pt.push(r))}function Ht(){var r,t;for(r=[],t=zt();t!==u;)r.push(t),t=zt();return r}function zt(){var t;return(t=function(){var t,e,n,o;if(t=Qt,r.substr(Qt,2)===w?(e=w,Qt+=2):(e=u,0===qt&&Bt(gr)),e!==u){if(n=[],tr.test(r.charAt(Qt))?(o=r.charAt(Qt),Qt++):(o=u,0===qt&&Bt(mr)),o!==u)for(;o!==u;)n.push(o),tr.test(r.charAt(Qt))?(o=r.charAt(Qt),Qt++):(o=u,0===qt&&Bt(mr));else n=u;n!==u?(r.substr(Qt,2)===k?(o=k,Qt+=2):(o=u,0===qt&&Bt(yr)),o!==u?t=it(n):(Qt=t,t=u)):(Qt=t,t=u)}else Qt=t,t=u;return t}())===u&&(t=function(){var t,e,n;return t=Qt,Vt(),r.substr(Qt,20).toLowerCase()===p?(e=r.substr(Qt,20),Qt+=20):(e=u,0===qt&&Bt(cr)),e!==u?(rr.test(r.charAt(Qt))?(n=r.charAt(Qt),Qt++):(n=u,0===qt&&Bt(ir)),n===u&&(n=null),Vt(),t=at()):(Qt=t,t=u),t}())===u&&(t=function(){var t,e,n;return t=Qt,Vt(),r.substr(Qt,21).toLowerCase()===d?(e=r.substr(Qt,21),Qt+=21):(e=u,0===qt&&Bt(hr)),e===u&&(r.substr(Qt,15).toLowerCase()===v?(e=r.substr(Qt,15),Qt+=15):(e=u,0===qt&&Bt(fr)),e===u&&(r.substr(Qt,3).toLowerCase()===g?(e=r.substr(Qt,3),Qt+=3):(e=u,0===qt&&Bt(pr)),e===u&&(r.substr(Qt,2).toLowerCase()===m?(e=r.substr(Qt,2),Qt+=2):(e=u,0===qt&&Bt(br)),e===u&&(r.substr(Qt,9).toLowerCase()===y?(e=r.substr(Qt,9),Qt+=9):(e=u,0===qt&&Bt(dr)),e===u&&(r.substr(Qt,4).toLowerCase()===A?(e=r.substr(Qt,4),Qt+=4):(e=u,0===qt&&Bt(vr))))))),e!==u?(rr.test(r.charAt(Qt))?(n=r.charAt(Qt),Qt++):(n=u,0===qt&&Bt(ir)),n===u&&(n=null),Vt(),t=ct()):(Qt=t,t=u),t}())===u&&(t=function(){var t,e,n;return t=Qt,Vt(),r.substr(Qt,21).toLowerCase()===b?(e=r.substr(Qt,21),Qt+=21):(e=u,0===qt&&Bt(lr)),e!==u?(rr.test(r.charAt(Qt))?(n=r.charAt(Qt),Qt++):(n=u,0===qt&&Bt(ir)),n===u&&(n=null),Vt(),t=ut()):(Qt=t,t=u),t}())===u&&(t=function(){var t,e,n,o,s,a;return t=Qt,Vt(),(e=It())!==u&&(n=Nt())!==u?(47===r.charCodeAt(Qt)?(o=h,Qt++):(o=u,0===qt&&Bt(ar)),o!==u&&(s=It())!==u&&(a=Nt())!==u?(Wt(),Vt(),t=ot(e,n,s,a)):(Qt=t,t=u)):(Qt=t,t=u),t}())===u&&(t=function(){var t,e,n,o,s,a;return t=Qt,Vt(),(e=It())!==u&&(n=Nt())!==u?(r.substr(Qt,2)===f?(o=f,Qt+=2):(o=u,0===qt&&Bt(ur)),o!==u&&(s=It())!==u&&(a=Nt())!==u?(Wt(),Vt(),t=st(e,n,s,a)):(Qt=t,t=u)):(Qt=t,t=u),t}())===u&&(t=function(){var t,e,n;return t=Qt,Vt(),r.substr(Qt,8).toLowerCase()===C?(e=r.substr(Qt,8),Qt+=8):(e=u,0===qt&&Bt(Ar)),e!==u?(rr.test(r.charAt(Qt))?(n=r.charAt(Qt),Qt++):(n=u,0===qt&&Bt(ir)),n===u&&(n=null),Vt(),t=lt()):(Qt=t,t=u),t}())===u&&(t=function(){var t,e,n;return t=Qt,Vt(),r.substr(Qt,7).toLowerCase()===x?(e=r.substr(Qt,7),Qt+=7):(e=u,0===qt&&Bt(wr)),e!==u?(rr.test(r.charAt(Qt))?(n=r.charAt(Qt),Qt++):(n=u,0===qt&&Bt(ir)),n===u&&(n=null),Vt(),t=ht()):(Qt=t,t=u),t}())===u&&(t=function(){var t,e,n;return t=Qt,Vt(),r.substr(Qt,7).toLowerCase()===L?(e=r.substr(Qt,7),Qt+=7):(e=u,0===qt&&Bt(kr)),e!==u?(rr.test(r.charAt(Qt))?(n=r.charAt(Qt),Qt++):(n=u,0===qt&&Bt(ir)),n===u&&(n=null),Vt(),t=ft()):(Qt=t,t=u),t}())===u&&(t=function(){var t,e,n;return t=Qt,Vt(),r.substr(Qt,7).toLowerCase()===j?(e=r.substr(Qt,7),Qt+=7):(e=u,0===qt&&Bt(Cr)),e!==u?(rr.test(r.charAt(Qt))?(n=r.charAt(Qt),Qt++):(n=u,0===qt&&Bt(ir)),n===u&&(n=null),Vt(),t=pt()):(Qt=t,t=u),t}())===u&&(t=function(){var t,e,n;return t=Qt,Vt(),r.substr(Qt,9).toLowerCase()===P?(e=r.substr(Qt,9),Qt+=9):(e=u,0===qt&&Bt(Qr)),e===u&&(r.substr(Qt,12).toLowerCase()===q?(e=r.substr(Qt,12),Qt+=12):(e=u,0===qt&&Bt(Mr))),e!==u?(rr.test(r.charAt(Qt))?(n=r.charAt(Qt),Qt++):(n=u,0===qt&&Bt(ir)),n===u&&(n=null),Vt(),t=gt()):(Qt=t,t=u),t}())===u&&(t=function(){var t,e,n;return t=Qt,Vt(),r.substr(Qt,5).toLowerCase()===M?(e=r.substr(Qt,5),Qt+=5):(e=u,0===qt&&Bt(Fr)),e===u&&(r.substr(Qt,6).toLowerCase()===E?(e=r.substr(Qt,6),Qt+=6):(e=u,0===qt&&Bt(Or))),e!==u?(rr.test(r.charAt(Qt))?(n=r.charAt(Qt),Qt++):(n=u,0===qt&&Bt(ir)),n===u&&(n=null),Vt(),t=vt()):(Qt=t,t=u),t}())===u&&(t=function(){var t,e,n;return t=Qt,Vt(),r.substr(Qt,5).toLowerCase()===F?(e=r.substr(Qt,5),Qt+=5):(e=u,0===qt&&Bt(jr)),e===u&&(r.substr(Qt,6).toLowerCase()===O?(e=r.substr(Qt,6),Qt+=6):(e=u,0===qt&&Bt(Rr)),e===u&&(r.substr(Qt,10).toLowerCase()===Q?(e=r.substr(Qt,10),Qt+=10):(e=u,0===qt&&Bt(Sr)))),e!==u?(rr.test(r.charAt(Qt))?(n=r.charAt(Qt),Qt++):(n=u,0===qt&&Bt(ir)),n===u&&(n=null),Vt(),t=dt()):(Qt=t,t=u),t}())===u&&(t=function(){var t,e,n;return t=Qt,Vt(),r.substr(Qt,13).toLowerCase()===R?(e=r.substr(Qt,13),Qt+=13):(e=u,0===qt&&Bt(xr)),e===u&&(r.substr(Qt,5).toLowerCase()===S?(e=r.substr(Qt,5),Qt+=5):(e=u,0===qt&&Bt(Lr))),e!==u?(rr.test(r.charAt(Qt))?(n=r.charAt(Qt),Qt++):(n=u,0===qt&&Bt(ir)),n===u&&(n=null),Vt(),t=bt()):(Qt=t,t=u),t}())===u&&(t=function(){var t,e,n;return t=Qt,Vt(),r.substr(Qt,7).toLowerCase()===D?(e=r.substr(Qt,7),Qt+=7):(e=u,0===qt&&Bt(Er)),e!==u?(rr.test(r.charAt(Qt))?(n=r.charAt(Qt),Qt++):(n=u,0===qt&&Bt(ir)),n===u&&(n=null),Vt(),t=mt()):(Qt=t,t=u),t}())===u&&(t=function(){var t,e,n;return t=Qt,Vt(),r.substr(Qt,12).toLowerCase()===G?(e=r.substr(Qt,12),Qt+=12):(e=u,0===qt&&Bt(Pr)),e===u&&(r.substr(Qt,15).toLowerCase()===T?(e=r.substr(Qt,15),Qt+=15):(e=u,0===qt&&Bt(qr)),e===u&&(r.substr(Qt,14).toLowerCase()===U?(e=r.substr(Qt,14),Qt+=14):(e=u,0===qt&&Bt(Dr)))),e!==u?(rr.test(r.charAt(Qt))?(n=r.charAt(Qt),Qt++):(n=u,0===qt&&Bt(ir)),n===u&&(n=null),Vt(),t=yt()):(Qt=t,t=u),t}())===u&&(t=function(){var r,t,e;return r=Qt,Vt(),(t=It())!==u&&(e=Nt())!==u?(Wt(),Vt(),r=nt(t,e)):(Qt=r,r=u),r}())===u&&(t=function(){var t,e;return t=Qt,Vt(),124===r.charCodeAt(Qt)?(e=_,Qt++):(e=u,0===qt&&Bt(Gr)),e!==u?(Vt(),t=At()):(Qt=t,t=u),t}()),t}function It(){var t,e,n,o,s;if(t=Qt,er.test(r.charAt(Qt))?(e=r.charAt(Qt),Qt++):(e=u,0===qt&&Bt(Tr)),e!==u){for(n=[],o=Jt();o!==u;)n.push(o),o=Jt();for(o=[],s=Kt();s!==u;)o.push(s),s=Kt();t=wt(e,n,o)}else Qt=t,t=u;return t}function Jt(){var t;return Qt,nr.test(r.charAt(Qt))?(t=r.charAt(Qt),Qt++):(t=u,0===qt&&Bt(Ur)),t!==u&&(t=kt()),t}function Kt(){var t;return Qt,or.test(r.charAt(Qt))?(t=r.charAt(Qt),Qt++):(t=u,0===qt&&Bt(_r)),t!==u&&(t=Ct()),t}function Nt(){var t;return Qt,(t=function(){var t;return Qt,r.substr(Qt,4).toLowerCase()===W?(t=r.substr(Qt,4),Qt+=4):(t=u,0===qt&&Bt(Wr)),t===u&&(r.substr(Qt,2)===X?(t=X,Qt+=2):(t=u,0===qt&&Bt(Xr)),t===u&&(r.substr(Qt,2)===Y?(t=Y,Qt+=2):(t=u,0===qt&&Bt(Yr)))),t!==u&&(t=Ot()),t}())===u&&((t=function(){var t;return Qt,r.substr(Qt,4).toLowerCase()===z?(t=r.substr(Qt,4),Qt+=4):(t=u,0===qt&&Bt(zr)),t===u&&(r.substr(Qt,2)===I?(t=I,Qt+=2):(t=u,0===qt&&Bt(Ir)),t===u&&(9651===r.charCodeAt(Qt)?(t=J,Qt++):(t=u,0===qt&&Bt(Jr)))),t!==u&&(t=Rt()),t}())===u&&((t=function(){var t;return Qt,r.substr(Qt,3).toLowerCase()===B?(t=r.substr(Qt,3),Qt+=3):(t=u,0===qt&&Bt(Br)),t!==u&&(t=Lt()),t}())===u&&((t=function(){var t;return Qt,r.substr(Qt,3).toLowerCase()===K?(t=r.substr(Qt,3),Qt+=3):(t=u,0===qt&&Bt(Kr)),t!==u&&(t=St()),t}())===u&&((t=function(){var t;return Qt,109===r.charCodeAt(Qt)?(t=N,Qt++):(t=u,0===qt&&Bt(Nr)),t===u&&(45===r.charCodeAt(Qt)?(t=V,Qt++):(t=u,0===qt&&Bt(Vr))),t!==u&&(t=Ft()),t}())===u&&(t=function(){var t;return Qt,77===r.charCodeAt(Qt)?(t=H,Qt++):(t=u,0===qt&&Bt(Hr)),t===u&&(t=""),t!==u&&(t=jt()),t}()))))),t!==u&&(t=xt(t)),t}function Vt(){var t,e;for(qt++,t=[],sr.test(r.charAt(Qt))?(e=r.charAt(Qt),Qt++):(e=u,0===qt&&Bt($r));e!==u;)t.push(e),sr.test(r.charAt(Qt))?(e=r.charAt(Qt),Qt++):(e=u,0===qt&&Bt($r));return qt--,e=u,0===qt&&Bt(Zr),t}function Wt(){var t,e,n,o;for(qt++,t=[],r.substr(Qt,3)===Z?(e=Z,Qt+=3):(e=u,0===qt&&Bt(tt)),e===u&&(e=Qt,n=Vt(),8594===r.charCodeAt(Qt)?(o=$,Qt++):(o=u,0===qt&&Bt(et)),o!==u?e=n=[n,o,Vt()]:(Qt=e,e=u));e!==u;)t.push(e),r.substr(Qt,3)===Z?(e=Z,Qt+=3):(e=u,0===qt&&Bt(tt)),e===u&&(e=Qt,n=Vt(),8594===r.charCodeAt(Qt)?(o=$,Qt++):(o=u,0===qt&&Bt(et)),o!==u?e=n=[n,o,Vt()]:(Qt=e,e=u));return qt--,e=u,0===qt&&Bt(rt),t}if((n=l())!==u&&Qt===r.length)return n;throw n!==u&&Qt<r.length&&Bt({type:"end"}),o=Pt,s=Et<r.length?r.charAt(Et):null,a=Et<r.length?_t(Et,Et+1):_t(Et,Et),new t(t.buildMessage(o,s),o,s,a)}}}},t={};function e(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return r[n](s,s.exports,e),s.exports}e.d=(r,t)=>{for(var n in t)e.o(t,n)&&!e.o(r,n)&&Object.defineProperty(r,n,{enumerable:!0,get:t[n]})},e.o=(r,t)=>Object.prototype.hasOwnProperty.call(r,t),e.r=r=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})};var n={};return(()=>{e.r(n),e.d(n,{chord2mml:()=>b});var r=e(699),t=function(r,t,e){if(e||2===arguments.length)for(var n,o=0,s=t.length;o<s;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return r.concat(n||Array.prototype.slice.call(t))};function o(r,t,e,n){void 0===e&&(e="root inv"),void 0===n&&(n="close");var o=[];switch(t){case"maj":o=[0,4,7];break;case"maj7":o=[0,4,7,11];break;case"min":o=[0,3,7];break;case"min7":o=[0,3,7,10]}return s(o=a(o,r),e,n)}function s(r,t,e){switch(t){case"1st inv":r=h(r,1);break;case"2nd inv":r=h(r,2);break;case"3rd inv":r=h(r,3)}switch(e){case"drop2":r=function(r){if(r.length<2)return r;var t=r[r.length-2]-12;return r.splice(r.length-2,1),r.unshift(t),r}(r);break;case"drop4":r=function(r){if(r.length<4)return r;var t=r[r.length-4]-12;return r.splice(r.length-4,1),r.unshift(t),r}(r);break;case"drop2and4":r=function(r){if(r.length<4)return r;var t=r[r.length-2]-12,e=r[r.length-4]-12;return r.splice(r.length-2,1),r.splice(r.length-4+1,1),r.unshift(t),r.unshift(e),r}(r)}return r}function a(r,t){for(var e=0;e<r.length;e++)r[e]+=t;return r}function u(r,t,e,n,o){var a=[];a.push(e);var u=c(r,t,e);return u=s(u,n,o),a.push.apply(a,u),a}function c(r,t,e){var n=o(r,t);return r<=e&&(n=a(n,12)),n}function i(r,t,e,n){var s=[];if("root"==n){s.push(r);var a=c(r,t,r);a=l(a,e),s.push.apply(s,a)}else s=l(s=o(r,t),e);return s}function l(r,t){for(var e=0;e<r.length&&(r[0]%12+12)%12!=(t%12+12)%12;e++)r.push(r.shift());return f(r)}function h(r,t){for(var e=0;e<t;e++)r.push(r.shift());return f(r)}function f(r){for(var t=-1,e=0;e<r.length;e++){for(var n=0;n<128&&!(r[e]>t);n+=12)r[e]+=12;t=r[e]}return r}function p(r,e,n,s){var a=o(n,s),u=o(r,e),c=t(t([],a,!0),u,!0);return f(c)}var b={parse:(r.parse,function(t){var e=(0,r.parse)(t);return function(r){for(var t="",e=0;e<r.length;e++){var n=r[e];switch(n.event){case"inline mml":t+=n.mml;continue;case"bar":t+="/*|*/";continue}var o=0;n.length&&(t+="'");for(var s=n[0];s<0;)s+=12,t+=">",o--;for(var a=0;a<n.length;a++){var u=n[a],c=Math.floor(u/12);switch(c>o&&(t+="<",o=c),(u%12+12)%12){case 0:t+="c";break;case 1:t+="c+";break;case 2:t+="d";break;case 3:t+="d+";break;case 4:t+="e";break;case 5:t+="f";break;case 6:t+="f+";break;case 7:t+="g";break;case 8:t+="g+";break;case 9:t+="a";break;case 10:t+="a+";break;case 11:t+="b"}}n.length&&(t+="'")}return t}(function(r){for(var t=[],e="root inv",n="close",s="no bass",a=0;a<r.length;a++){var c=r[a],l=void 0;switch(c.event){case"chord":l=o(c.root,c.quality,e,n),t.push(l);break;case"chord over bass note":l=u(c.upperRoot,c.upperQuality,c.lowerRoot,e,n),t.push(l);break;case"inversion":l=i(c.upperRoot,c.upperQuality,c.lowerRoot,s),t.push(l);break;case"polychord":l=p(c.upperRoot,c.upperQuality,c.lowerRoot,c.lowerQuality),t.push(l);break;case"change inversion mode to root inv":e="root inv";break;case"change inversion mode to 1st inv":e="1st inv";break;case"change inversion mode to 2nd inv":e="2nd inv";break;case"change inversion mode to 3rd inv":e="3rd inv";break;case"change open harmony mode to close":n="close";break;case"change open harmony mode to drop2":n="drop2";break;case"change open harmony mode to drop4":n="drop4";break;case"change open harmony mode to drop2and4":n="drop2and4";break;case"change bass play mode to root":s="root";break;case"change bass play mode to no bass":s="no bass";break;default:t.push(c)}}return t}(e=function(r){for(var t="chord over bass note",e="no bass",n=0;n<r.length;n++){var o=r[n];switch(o.event){case"change slash chord mode to chord over bass note":t="chord over bass note";break;case"change slash chord mode to inversion":t="inversion";break;case"change slash chord mode to polychord":t="polychord";break;case"slash chord":o.event=t;break;case"change bass play mode to root":e="root";break;case"change bass play mode to no bass":e="no bass";break;case"chord":"root"==e&&(o.event="chord over bass note",o.upperRoot=o.root,o.upperQuality=o.quality,o.lowerRoot=o.root,o.lowerQuality=o.quality,delete o.root,delete o.quality)}}return r}(e)))})}})(),n})()));